import { Meta, Story, Canvas } from '@storybook/addon-docs/blocks';

import PbTable from './Table.vue';
import PbButton from '../../Buttons/Button/Button.vue';

<Meta
  title = "Components/Data Visualization/PbTable"
  component = { PbTable }
  argTypes = {{
    header: {
      type: 'array',
      defaultValue: [
        { label: 'Nome', size: 3, priority: 1 },
        { label: 'Idade', size: 3, priority: 3 },
        { label: 'Banco Principal', size: 3, priority: 2 },
        { label: 'Status', size: 1, priority: 1 },
      ],
    },
    rows: {
      type: 'array',
      defaultValue: [
        [
          { value: 'João Paulo de Ávila Alfredo', secondaryValue: '123.456.789-10' },
          { value: '20' },
          { value: 'https://s3-sa-east-1.amazonaws.com/adapcon-pro-production-customer/script-financeiro/bacen-237.png' },
          { badges: [{ value: 'Finalizado', backgroundColor: 'success-light', fontColor: 'success', size: 'pb-md' }] },
        ],
        [
          { value: 'Maria da Silva', secondaryValue: '661.313.649-23' },
          { value: '22', },
          { value: 'https://s3-sa-east-1.amazonaws.com/adapcon-pro-production-customer/script-financeiro/bacen-341.png' },
          { badges: [{ value: 'Finalizado', backgroundColor: 'success-light', fontColor: 'success', size: 'pb-md' }] },
        ],
        [
          { value: 'Lucca Gael Ferreira', secondaryValue: '898.372.281-30' },
          { value: '16', },
          { value: 'Não informado', badges: [{ value: 'menor de idade' }] },
          { badges: [{ value: 'Finalizado', backgroundColor: 'success-light', fontColor: 'success', size: 'pb-md' }] },
        ],
        [
          { value: 'Sofia Jennifer Gomes da Silva Mendes de Souza', secondaryValue: '398.722.811-30' },
          { value: '23', },
          { value: 'Sem preferência' },
          { badges: [{ value: 'Finalizado', backgroundColor: 'success-light', fontColor: 'success', size: 'pb-md' }] },
        ],
        [
          { value: 'Mário Oliveira', secondaryValue: '898.372.281-30' },
          { value: '11', },
          { value: 'Não informado', badges: [{ value: 'menor de idade'}, { value: '<12' }] },
          { badges: [{ value: 'Finalizado', backgroundColor: 'success-light', fontColor: 'success', size: 'pb-md' }] },
        ],
      ],
    },
    metadata: {
      type: 'array',
      defaultValue: [
        { name: 'João Paulo de Ávila', cpf: '12345678910', driverLicense: true },
        { name: 'Maria da Silva', cpf: '66131364923', driverLicense: true },
        { name: 'Lucca Gael Ferreira', cpf: '89837228130', driverLicense: false },
        { name: 'Sofia Jennifer Gomes da Silva Mendes de Souza', cpf: '39872281130', driverLicense: true },
        { name: 'Mário Oliveira', cpf: '89837228130', driverLicense: false }
      ],
    },
    loading: { type: 'boolean', defaultValue: false },
    ellipsisOnOverflow: { type: 'boolean', defaultValue: true },
    highlightOnHover: { type: 'boolean', defaultValue: true },
    hasActionColumn: { type: 'boolean', defaultValue: true },
    hasSort: { type: 'boolean', defaultValue: true },
    hasActionsBar: { type: 'boolean', defaultValue: true },
    maxHeight: { type: 'string', defaultValue: '' },
    actionsSize: { type: 'number', defaultValue: 1 },
  }}
/>

export const Template = (args, { argTypes }) => ({
  props: Object.keys(argTypes),
  components: { PbTable, PbButton },
  template: `
    <div style="background-color: white;">
      <PbTable
        :header="header"
        :rows="rows"
        :metadata="metadata"
        :loading="loading"
        :ellipsis-on-overflow="ellipsisOnOverflow"
        :highlight-on-hover="highlightOnHover"
        :has-action-column="hasActionColumn"
        :has-sort="hasSort"
        :has-actions-bar="hasActionsBar"
        :max-height="maxHeight"
        :actions-size="actionsSize"
      >
        <template #actions="{ row, metadata }">
          <div style="display: flex;">
            <PbButton
              icon="fas fa-star"
              button-style="regular"
            />
            <PbButton
              v-if="row[2].badges && row[2].badges.find(badge => badge === '< 12')"
              icon="fas fa-info-circle"
              button-style="regular"
            />
            <PbButton
              v-if="metadata.driverLicense"
              icon="fas fa-image"
              button-style="regular"
            />
          </div>
        </template>
      </PbTable>
    </div>
  `,
});

export const TemplateWithoutActions = (args, { argTypes }) => ({
  props: Object.keys(argTypes),
  components: { PbTable },
  template: `
    <div style="background-color: white;">
      <PbTable
        :header="header"
        :rows="rows"
        :metadata="metadata"
        :loading="loading"
        :ellipsis-on-overflow="ellipsisOnOverflow"
        :highlight-on-hover="highlightOnHover"
        :has-action-column="hasActionColumn"
        :has-sort="hasSort"
        :has-actions-bar="hasActionsBar"
        :max-height="maxHeight"
        :actions-size="actionsSize"
      />
    </div>
  `,
});

export const TemplateWithExtraActions = (args, { argTypes }) => ({
  props: Object.keys(argTypes),
  components: { PbTable, PbButton },
  template: `
    <div style="background-color: white;">
      <PbTable
        :header="header"
        :rows="rows"
        :metadata="metadata"
        :loading="loading"
        :ellipsis-on-overflow="ellipsisOnOverflow"
        :highlight-on-hover="highlightOnHover"
        :has-action-column="hasActionColumn"
        :has-sort="hasSort"
        :has-actions-bar="hasActionsBar"
        :max-height="maxHeight"
        :actions-size="actionsSize"
      >
        <template #extra-actions>
          <PbButton
            label="Baixar CSV"
            button-style="background"
          />
        </template>
      </PbTable>
    </div>
  `,
});

# **PbTable Component**
### The `PbTable` component is a table used to display data.

### Purpose and Use case

The table is usually used in pages to list content.

## Configuration

### Header

List wiht one object to each column of table.

| Property                    | Type                   | Default | Description                                                                                   |
|:----------------------------|:-----------------------|:--------|:----------------------------------------------------------------------------------------------|
| label                       | String, Number         |         | The column label                                                                              |
| size                        | Number                 |         | The size of column. The table uses the 12 column grid bootstrap system                        |
| priority                    | Number                 |         | The priority of column. It is used to hide column  when occurs a overflow.                    |

### Rows

List of arrays to each row, containing one object to each column of table;

| Property                    | Type                   | Default | Description                                                                                   |
|:----------------------------|:-----------------------|:--------|:----------------------------------------------------------------------------------------------|
| value                       | String, Number, Image  |         | The column value                                                                              |
| secondaryValue              | String, Number         |         | A extra info to column (Optional).                                                            |
| badges                      | Object                 |         | A list of badges to column. Example: badges: [{ value: 'Finalizado', backgroundColor: 'primary', fontColor: 'white', size: 'pb-md' }].  (Optional) |

### Properties

| Property                    | Type        | Default | Description                                                                                              |
|:----------------------------|:------------|:--------|:---------------------------------------------------------------------------------------------------------|
| metadata                    | Array       |         | A list of metadata about each row in table. It is available in actions slot (Optional).                  |
| loading                     | Boolean     | false   | Indicates that data is being loaded and when true a loading bar is displayed.                            |
| ellipsisOnOverflow          | Boolean     | true    | Shows ellipsis on overflow and display the rest of the information in a hint.                            |
| highlightOnHover            | Boolean     | true    | Highlights the row on hover.                                                                             |
| hasActionColumn             | Boolean     | true    | Shows the action column. When activated you can use the actions slot to put actions inside.              |
| hasSort                     | Boolean     | true    | Allows sorting in columns.                                                                               |
| hasActionsBar               | Boolean     | true    | Shows the actions bar, with a search input and a extra-actions slot.                                     |
| maxHeight                   | String      |         | Sets a maximumn height to table. Should have the unit of measure.                                        |
| actionsSize                 | Number      | 1       | Sets the size of actions column.                                                                         |                                                                  |

### Events

| Event                       | Type        | Emitter                            | Description                                                                   |
|:----------------------------|:------------|:-----------------------------------|:------------------------------------------------------------------------------|
| search                      | String      | Input data in searchinput          | Emits the search term                                                         |
| clear-input                 |             | Clean the search input             | Emits that search input has been cleared                                      |

### Slots

| Name                       | Props           | Description                                                                                                                                |
|:---------------------------|:----------------|:-------------------------------------------------------------------------------------------------------------------------------------------|
| actions                    | row, metadata   | This slot is displayed in actions column. It available two properties: row (the columns objects) and metadata (the wor metadata).          |
| extra-actions              |                 | This slot is displayed on the right side of the search input.                                                                              |


## Examples

### Default

<Canvas>
  <Story name="Default" height="auto">
    { Template.bind({}) }
  </Story>
</Canvas>


### Without Actions

<Canvas>
  <Story name="Without Actions" height="auto" args={{ hasActionColumn: false }}>
    { TemplateWithoutActions.bind({}) }
  </Story>
</Canvas>

### With Extra Actions

<Canvas>
  <Story name="With Extra Actions" height="auto">
    { TemplateWithExtraActions.bind({}) }
  </Story>
</Canvas>

